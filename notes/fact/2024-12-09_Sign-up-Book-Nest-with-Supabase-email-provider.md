---
date: 2024-12-09
type: fact
aliases:
  -
hubs:
  - "[[sv5]]"
---

# Sign up Book Nest with Supabase email provider

In [[2024-12-09_Create-Superbase-project-and-get-required-variables-for-Book-Nest|this topic]], we already create a Supabase project and store the required variables in the `.env` file. So, now we can use these variables to sign up with the Supabase email provider easily.

**1. Install the required packages**

```bash
~/D/g/s/s/book-nest > npm i @supabase/ssr @supabase/supabase-js # one is for server-side rendering and another is for client-side

```
**2. Create Supabase client instance and use it to sing up the new user**

```ts
~/D/g/s/s/book-nest > cat src/routes/register/+page.server.ts
import type { Actions } from './$types';
import { createClient } from '@supabase/supabase-js';  // import the createClient fn from the package
import { PUBLIC_SUPABASE_ANON_KEY, PUBLIC_SUPABASE_URL } from '$env/static/public' // import the Supabase URL and anon key from the .env file
import { fail, redirect } from '@sveltejs/kit';  // not return simple object, instead use return fail() signing up fail or redirect() when signing up successfully

interface ReturnObject {
  success: boolean;
  errors: string[];
}

export const actions = {
  default: async ({ request }) => {

    const formData = await request.formData();

    const name = formData.get('name') as string;
    const email = formData.get('email') as string;
    const password = formData.get('password') as string;
    const passwordConfirm = formData.get('passwordConfirm') as string;

    const returnObject: ReturnObject = {
      success: true,
      errors: [],
    };

    if (name.length < 3) returnObject.errors.push('Name must be at least 3 characters long');
    if (!email.length) returnObject.errors.push('Email is required');
    if (!password.length) returnObject.errors.push('Password is required');
    if (password !== passwordConfirm) returnObject.errors.push('Passwords do not match');
    
    if (returnObject.errors.length) returnObject.success = false;


    // instead of returning the object, now we want to sign up the user with Supabase
  
    // return returnObject;

    const supabase = createClient(PUBLIC_SUPABASE_URL, PUBLIC_SUPABASE_ANON_KEY); // create a Supabase client instance with the Supabase URL and anon key
                                                                                  // this is also allow in the client side

    const { data, error } = await supabase.auth.signUp({ email, password })  // simple use method signUp to sign up the user with email and password
                                                                            // it always return data or error object only

    // when signing up fail, we return the error message which is generated by fail() from `@sveltejs/kit`
    if (error || !data.user) {
      console.log("There was an error signing up", error);
      returnObject.success = true;
      return fail(400, returnObject as any)
    }

    // when signing up successfully, we redirect the user to the dashboard page
    redirect(303, "/private/dashboard");


  }
} satisfies Actions;

```

```bash
~/D/g/s/s/book-nest > npm run dev

# try to sign up with the email and password on the browser
# it should redirect to the dashboard page when signing up successfully

```
Check the Supabase dashboard, you should see the new user is created in the Auth section.

![new-user.png](../assets/imgs/new-user.png)


